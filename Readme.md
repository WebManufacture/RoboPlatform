# RoboPlatform

###### Общее

Универсальная платформа для построения систем цифровой автоматизации и роботизации. Платформа разрабатывается, как самостоятельный проект, развитие идеи Arduino. В качестве основных контроллеров, используемых в платформе, выбрана линейка контроллеров от компании ST Microelectronics (STM8, STM32 ARM).
Основные принципы и идеи платформы:

0. Возможность создания по большей части самовоспроизводимой системы модулей. Имеется ввиду, что на базе существующей системы модулей и инструментов можно создавать как свою копию, так и новые, перспективные.
1. Сделать компоненты настолько дешевыми, чтобы их можно было использовать свободно, как "кирпичики" для построения сложных систем, состоящих из огромного числа отлаженных модулей. Также дешевизна и простота модулей, делает возможным их применение в условиях кризиса или бесконечно-малого финансирования.
2. По контроллеру - в каждый узел! Идея состоит в том, чтобы создать общее программное облако, с помощью которого, можно создавать самоконфигурируемые, самособирающиеся, самотестируемые и другие системы, требующие интерактивности от каждого своего функционального узла от мала до велика. Благо, современная конкуренция на рынке контроллеров дает возможность приобретать 8ми разрядные контроллеры по цене < $0.5, и ARM-контолллеры от 1$.
3. Облегчение и автоматизация труда разработчика. Предполагается применение разработок Web-Manufacture.net (KLAB, HLAB, ILAB и прочих), а также создание современных систем управления, разработки и тестирования для этой платформы. Под "современностью" понимается использования опыта разработки для систем более высокого уровня, применительно, к несколько "поотставшей" области программирования и отладки систем на контроллерах.
4. Использовать коммуникационные протоколы и принципы проекта ILAB
5. "Селективная шина" в качестве основной модели взаимодействия 

###### XRouting

Это -- протокол и сердце системы.

         (#xx | #1x)( #dstAddr ...,  #srcAddr..., #size, #pmo,#pm, #value,...,#pms, #pm, value..., #pme, #pme, (#crc) ? #03
         1x - XRT packet type

             11 Hi (Hi, when raise node)
             12 Dying (Something wrong, buy or error, Unscribe, Del)
             13 Acknowledge (Response, for anything, for example "see you as")
             14 Things (Get Description, Get anything, Add, Set)
             15 Lookup (All, Subscribe)
             16 Redirect (Info)
             17 Forward  (Note)
             18 Tunnel

         xx #SYNC
             #A0-#A9 - #Req
             #B0-#B9 - #Ack
             #C0-#C9 - Reserved
             #E0-#EF   #syncData1 #syncData2
             #F0-FF    #syncData (1Byte)

         #addr (#dstAddr, #srcAddr)
             First 1bits of address means this is end of address chain
             0 - packet chain
             1 - end packet
             Special bytes in packet chain may have sense -- delimeter, mark of the address type

       

         pm = packet marker ( 3bit - dataType + 5bit thing identifier )
              pm data types:

              00 - Raw Data, for a strings or something encoded, looking the next PM
              01 - Sized    something have fixed size, things identifier describe size
              10 - #pmo Complex start with another PM's
              11 - #pme Complex End
   
###### Текущая стадия и план.

На сегодня разработана и продумана общая концепция проекта. Проект разбит на несколько автономных, но взаимосвязанных подпроектов. Наибольший прогресс в области создания ПО, в частности распределенной клиент-серверной инфраструктуры и пользовательских интерфейсов. 
Реализованы “в железе” основные модули и базовый набор инстументов проекта, как то RoboMotors, RoboMind, RoboPwm, RoboPower, являющиеся концептуальными наследниками своих программных прототипов. 
Некоторые подпроекты уже имеют собственную жизнь, как RoboCNC, RoboPainter и RoboRails, трудящееся в автоматизированых теплицах.
В рамках платформы необходима реализация 3х подпроектов, каждый из которых заслуживает отдельного описания.

1. Инструменты и механическая часть.
2. Набор электронных модулей, воспроизводимых в системе на базе RoboCNC.
3. ПО сегодня базирующееся на разработках Web-Manufacture.


RoboMind 

Контроллер представляет собой некий "Мозг", который может чем-либо управлять. Причем может делать это как автономно, так и в связке с компьютером или Web-интерфейсом.
Управление осуществляется с помощью "модулей" для у правления чем-то конкретным (освещением, двигателем, другими контроллерами), которые подключаются к общей шине или к порту. Порт представляет собой 3 вывода, 1 сигнальный и 2 для питания электроники (На фото видно несколько подключенных конечных устройств). 

Главное преимущество такого контроллера в собранном виде - готовое устройство стоит порядка 5$ за штуку! Или же 7$ на базе ARM!!!

В данном экземпляре есть 20 портов для непосредственного управления конечными устройствами (например, драйвером STEP-DIR, или же, драйвером светодиодов), и общая шина UART-LIN для связи с другими модулями системы. (такой тип шины используется в промышленности и современных автомобилях для периферии). Данный модуль основан на контроллере STM8S105K6, и подключается к ПК через USB или же через шину UART (COM-порт).

В новой версии уже будет использован мощный контроллер ARM (STM32F103CBT6). Кроме того, планируется расширить набор интерфейсов, выведеных "наружу". В частности, I2C, CAN, SD. А в модулях RoboVision, еще и HDMI.

Идея модуля в том, что он может запоминать программу, которую необходимо выполнять, управляя периферией, как дирижер - оркестром. Например, в архитектурном макете данный контроллер руководит всей автоматизацией исполняя запрограммированную последовательность действий.

В ПО для контроллера используется интересный подход, как "набор прошивок", которые пользователь может свободно выбирать, и загружать через встроенный BootLoader. Таким образом из данного мозга можно сделать широкий спектр устройств. Например, существует прошивки, которая позволяют сделать из данного модуля логический анализатор, контроллер ЧПУ, контроллер общего назначения, работающий по временным интервалам. 

Главная особенность разработки с использованием таких модулей, заключается в ПО "Конфигуратор", которое позволяет в реальном времени собирать из таких кирпичиков конечное решение, и сконфигурировать каждый его узел. Или же, произвести отладку всего "оркестра". За счет общей шины, каждый узел может отчитываться "мозгу" или ПК о своем состоянии или конфигурации. Именно над этим конфигуратором сейчас идет работа..

Также, каждая прошивка, может управляться своими собственными программами. Коих существует уже несколько, и все они развиваются.
